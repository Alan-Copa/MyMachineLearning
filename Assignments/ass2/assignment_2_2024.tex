\section*{Solution: Convolutional Network Design}

We aim to design a convolutional network that reduces the input \( 32 \times 32 \) image with 3 channels into \( 4 \times 4 \) feature maps with 64 channels. Below is the architecture, layer-by-layer computations, and the total number of learnable parameters.

\subsection*{Architecture}
\begin{enumerate}
    \item \textbf{Input feature map:} \( 32 \times 32 \), 3 feature maps.

    \item \textbf{Conv Layer 1:}
    \begin{itemize}
        \item Kernel size: \( 3 \times 3 \)
        \item Input channels: 3
        \item Output channels: 16
        \item Output size:
        \[
        \text{Output size} = (32 - 3 + 1) \times (32 - 3 + 1) = 30 \times 30
        \]
        \item Output feature maps: \( 30 \times 30 \), 16 feature maps.
        \item Number of parameters:
        \[
        \text{Weights: } 3 \times 3 \times 3 \times 16 = 432, \quad \text{Biases: } 16
        \]
        \[
        \text{Total: } 432 + 16 = 448
        \]
    \end{itemize}

    \item \textbf{Max-Pooling Layer 1:}
    \begin{itemize}
        \item Pooling size: \( 2 \times 2 \)
        \item Stride: 2
        \item Output size:
        \[
        \text{Output size} = \frac{30}{2} \times \frac{30}{2} = 15 \times 15
        \]
        \item Output feature maps: \( 15 \times 15 \), 16 feature maps.
    \end{itemize}

    \item \textbf{Conv Layer 2:}
    \begin{itemize}
        \item Kernel size: \( 3 \times 3 \)
        \item Input channels: 16
        \item Output channels: 32
        \item Output size:
        \[
        \text{Output size} = (15 - 3 + 1) \times (15 - 3 + 1) = 13 \times 13
        \]
        \item Output feature maps: \( 13 \times 13 \), 32 feature maps.
        \item Number of parameters:
        \[
        \text{Weights: } 3 \times 3 \times 16 \times 32 = 4608, \quad \text{Biases: } 32
        \]
        \[
        \text{Total: } 4608 + 32 = 4640
        \]
    \end{itemize}

    \item \textbf{Max-Pooling Layer 2:}
    \begin{itemize}
        \item Pooling size: \( 2 \times 2 \)
        \item Stride: 2
        \item Output size:
        \[
        \text{Output size} = \frac{13}{2} \times \frac{13}{2} = 6 \times 6
        \]
        \item Output feature maps: \( 6 \times 6 \), 32 feature maps.
    \end{itemize}

    \item \textbf{Conv Layer 3:}
    \begin{itemize}
        \item Kernel size: \( 3 \times 3 \)
        \item Input channels: 32
        \item Output channels: 64
        \item Output size:
        \[
        \text{Output size} = (6 - 3 + 1) \times (6 - 3 + 1) = 4 \times 4
        \]
        \item Output feature maps: \( 4 \times 4 \), 64 feature maps.
        \item Number of parameters:
        \[
        \text{Weights: } 3 \times 3 \times 32 \times 64 = 18432, \quad \text{Biases: } 64
        \]
        \[
        \text{Total: } 18432 + 64 = 18496
        \]
    \end{itemize}
\end{enumerate}

\subsection*{Final Architecture Summary}
\begin{itemize}
    \item Input feature map: \( 32 \times 32 \), 3 feature maps.
    \item Conv Layer 1: \( 3 \times 3 \) kernel, 3 input channels, 16 output channels.
        \begin{itemize}
            \item Output: \( 30 \times 30 \), 16 feature maps.
        \end{itemize}
    \item Max-Pooling Layer 1: \( 2 \times 2 \) pooling.
        \begin{itemize}
            \item Output: \( 15 \times 15 \), 16 feature maps.
        \end{itemize}
    \item Conv Layer 2: \( 3 \times 3 \) kernel, 16 input channels, 32 output channels.
        \begin{itemize}
            \item Output: \( 13 \times 13 \), 32 feature maps.
        \end{itemize}
    \item Max-Pooling Layer 2: \( 2 \times 2 \) pooling.
        \begin{itemize}
            \item Output: \( 6 \times 6 \), 32 feature maps.
        \end{itemize}
    \item Conv Layer 3: \( 3 \times 3 \) kernel, 32 input channels, 64 output channels.
        \begin{itemize}
            \item Output: \( 4 \times 4 \), 64 feature maps.
        \end{itemize}
\end{itemize}

\subsection*{Total Number of Learnable Parameters}
\begin{itemize}
    \item Conv Layer 1: \( 448 \)
    \item Conv Layer 2: \( 4640 \)
    \item Conv Layer 3: \( 18496 \)
\end{itemize}
\[
\text{Total Parameters} = 448 + 4640 + 18496 = 23584
\]

\subsection*{Conclusion}
The designed convolutional network outputs \( 4 \times 4 \) feature maps with 64 channels and has a total of 23,584 learnable parameters.
